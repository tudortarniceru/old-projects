<!DOCTYPE html>
<html>
	<meta charset="UTF-8"> 
	<head>
		<link rel="icon" href="favicon.ico" type="image/gif" sizes="16x16">
		<title>Switch - Tudor Tarniceru</title>
		<link rel="stylesheet" href="style.css">
		<script>
			var n = 10;
			var m = 10;
			var v = [];
			var a = [];
			var vc = [];
			var d1 = [0, -1, 0, 1, 0];
			var d2 = [0, 0, 1, 0, -1];
			var clk = 0;
			var stk = 0;
			var ply = 1;
			var done = 0;
			function check() {
				var ok = 1;
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						if (v[i][j] != a[i][j]) {
							ok = 0;
							i = n + 10;
							j = m + 10;
						}
					}
				}
				wrt();
				if (ok == 1) {
					ply = 0;
					document.getElementById("desc").innerHTML = "<b>Congratulations! You won!<b>";
					document.getElementById("start").innerHTML = "<button id='replayg' onclick=restartg()>Replay</button>";
					if (done == 0) {
						stk++;
					}
					done = 1;
				}
				clk++;
				document.getElementById("score").innerHTML = clk;
				document.getElementById("streak").innerHTML = stk;
			}
			function init() {
				for (i = 0; i <= n + 1; ++i) {
					v[i] = [];
					a[i] = [];
					vc[i] = [];
					for (j = 0; j <= m + 1; ++j) {
						v[i][j] = 0;
						a[i][j] = 0;
						vc[i][j] = 0;
					}
				}
			}
			init();
			function randnr() {
				var xg = Math.random();
				xg = xg * 10;
				xg = Math.round(xg);
				xg = xg % 2;
				return xg;
			}
			function chg(x, y) {
				if (ply == 1) {
					for (k = 0; k <= 4; ++k) {
						v[x + d1[k]][y + d2[k]]++;
						v[x + d1[k]][y + d2[k]] %= 2;
					}
					check();
				}
			}
			function chgv(x, y) {
				for (k = 0; k <= 4; ++k) {
					v[x + d1[k]][y + d2[k]]++;
					v[x + d1[k]][y + d2[k]] %= 2;
				}
			}
			function gen() {
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						var x = randnr();
						v[i][j] = x;
						a[i][j] = x;
					}
				}
			}
			function gena() {
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						var x = randnr();
						if (x == 1) {
							chgv(i, j);
						}
					}
				}
				var df = 0;
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						if (v[i][j] != a[i][j]) {
							df++;
						}
					}
				}
				if (df == 0) {
					gena();
				}
				else if (df < 2) {
					if (n >= 3) {
						gena();
					}
				}
			}
			function copy() {
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= n; ++j) {
						vc[i][j] = v[i][j];
					}
				}
			}
			copy();
			function wrt() {
				document.getElementById("v").innerHTML = "";
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						if (v[i][j] == 1) {
							document.getElementById("v").innerHTML += "<div class='block pl one' onclick=chg(" + i + "," + j +")></div>";
						}
						else {
							document.getElementById("v").innerHTML += "<div class='block pl zero' onclick=chg(" + i + "," + j +")></div>";
						}
					}
					document.getElementById("v").innerHTML += "<br>";
				}
			}
			function wrta() {
				document.getElementById("a").innerHTML = "";
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						if (a[i][j] == 1) {
							document.getElementById("a").innerHTML += "<div class='block one'></div>";
						}
						else {
							document.getElementById("a").innerHTML += "<div class='block zero'></div>";
						}
					}
					document.getElementById("a").innerHTML += "<br>";
				}
			}
			function restartg() {
				for (i = 1; i <= n; ++i) {
					for (j = 1; j <= m; ++j) {
						v[i][j] = vc[i][j];
					}
				}
				if (done == 0) {
					stk = 0;
				}
				document.getElementById("start").innerHTML = "<button id='restartb' onclick=restartg()>Restart</button>";
				document.getElementById("desc").innerHTML = "<b>How to play:</b> Click on a square from the left grid to change its and its neighbours colour.<br>Make both grids look the same.";
				wrt();
				clk = 0;
				ply = 1;
				document.getElementById("score").innerHTML = clk;
				document.getElementById("streak").innerHTML = stk;
			}
			function start() {
				if (done == 0) {
					stk = 0;
				}
				done = 0;
				gen();
				gena();
				copy();
				wrt();
				wrta();
				document.getElementById("start").innerHTML = "<button id='restartg' onclick=restartg()>Restart</button>";
				document.getElementById("newg").innerHTML = "<button id='newg' onclick=start()>New Game</button>";
				document.getElementById("desc").innerHTML = "<b>How to play:</b> Click on a square from the left grid to change its and its neighbours colour.<br>Make both grids look the same.";
				clk = 0;
				ply = 1;
				document.getElementById("score").innerHTML = clk;
				document.getElementById("streak").innerHTML = stk;
			}
			function d2x2() {
				n = 2;
				m = 2;
				start();
			}
			function d3x3() {
				n = 3;
				m = 3;
				start();
			}
			function d4x4() {
				n = 4;
				m = 4;
				start();
			}
			function d5x5() {
				n = 5;
				m = 5;
				start();
			}
			function d6x6() {
				n = 6;
				m = 6;
				start();
			}
			function d7x7() {
				n = 7;
				m = 7;
				start();
			}
			function d8x8() {
				n = 8;
				m = 8;
				start();
			}
		</script>
	</head>
	<body>
		<center>
			<div class="game_zone">
				<h3>Switch</h3>
				<div class="gsquare v" id="v">
				
				</div>
				<div class="gsquare a" id="a">
				
				</div>
				<div style="clear:both;">
					<p id="desc" style="height:40px; width:900px"><b>How to play:</b> Click on a square from the left grid to change its and its neighbours colour.<br>Make both grids look the same.</p>
					<p><span id="bf_score" style="font-weight:bold; height:20px;">Score: <span id="score">-</span>&nbsp;|&nbsp;<span id="bf_streak" style="font-weight:bold; height:20px;">Win Streak: <span id="streak">-</span></p>
					<p style="height:30px;"><span id = "start">Choose the size of the grids.</span> <span id="newg"></span></p>
					<p><button id="d2x2" onclick=d2x2()>2x2</button> <button id="d3x3" onclick=d3x3()>3x3</button> <button id="d4x4" onclick=d4x4()>4x4</button> <button id="d5x5" onclick=d5x5()>5x5</button> <button id="d6x6" onclick=d6x6()>6x6</button> <button id="d7x7" onclick=d7x7()>7x7</button> <button id="d8x8" onclick=d8x8()>8x8</button></p>
					<h4>Created by Tudor Ta&#774;rniceru</h4>
					<h5>Alpha(&alpha;) Version</h5>
				</div>
			</div>
		</center>
	</body>
</html>